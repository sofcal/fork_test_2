DBQuery.shellBatchSize = 11000;
db.BankAccount.aggregate([
{ 
    $match : 
    {
        dataProvider:"indirect",
        aggregatorName:"yodlee", 
        status:"cancelled",
        }},
{
    $project: {
        accountIdentifier: 1,
        dataProvider: 1,
        aggregatorName: 1,
        status: 1,
        toUpdate: { $ne:["$_id","$accountIdentifier"] }
        }
},
{ 
    $match : 
    {
        toUpdate : true
        }}
])